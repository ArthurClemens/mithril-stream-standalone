!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n="undefined"!=typeof globalThis?globalThis:n||self).mithrilStream=t()}(this,(function(){"use strict";function n(n){return r((function(){return n.map((function(n){return n()}))}),n)}function t(n){return"pending"===n._state||"active"===n._state||"changing"===n._state}var e=function(n){var a,i=[],u=[];function o(r){return arguments.length&&r!==e.SKIP&&(n=r,t(o)&&(o._changing(),o._state="active",i.slice().forEach((function(e,r){t(e)&&e(this[r](n))}),u.slice()))),n}function c(){return(a=e()).map((function(n){return!0===n&&(o._parents.forEach((function(n){n._unregisterChild(o)})),o._state="ended",o._parents.length=i.length=u.length=0),n})),a}return o.constructor=e,o._state=arguments.length&&n!==e.SKIP?"active":"pending",o._parents=[],o._changing=function(){t(o)&&(o._state="changing"),i.forEach((function(n){n._changing()}))},o._map=function(t,r){var a=r?e():e(t(n));return a._parents.push(o),i.push(a),u.push(t),a},o.map=function(n){return o._map(n,"active"!==o._state)},o.toJSON=function(){return null!=n&&"function"==typeof n.toJSON?n.toJSON():n},o["fantasy-land/map"]=o.map,o["fantasy-land/ap"]=function(n){return r((function(n,t){return n()(t())}),[n,o])},o._unregisterChild=function(n){var t=i.indexOf(n);-1!==t&&(i.splice(t,1),u.splice(t,1))},Object.defineProperty(o,"end",{get:function(){return a||c()}}),o};function r(n,t){var r=t.every((function(n){if(n.constructor!==e)throw new Error("Ensure that each item passed to stream.combine/stream.merge/lift is a stream.");return"active"===n._state})),a=r?e(n.apply(null,t.concat([t]))):e(),i=[],u=t.map((function(e){return e._map((function(u){return i.push(e),(r||t.every((function(n){return"pending"!==n._state})))&&(r=!0,a(n.apply(null,t.concat([i]))),i=[]),u}),!0)})),o=a.end.map((function(n){!0===n&&(u.forEach((function(n){n.end(!0)})),o.end(!0))}));return a}e.SKIP={},e.lift=function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return n(e).map((function(n){return t.apply(void 0,n)}))},e.scan=function(n,t,r){var a=r.map((function(r){var a=n(t,r);return a!==e.SKIP&&(t=a),a}));return a(t),a},e.merge=n,e.combine=r,e.scanMerge=function(n,t){var e=n.map((function(n){return n[0]})),a=r((function(){var r=arguments[arguments.length-1];return e.forEach((function(e,a){r.indexOf(e)>-1&&(t=n[a][1](t,e()))})),t}),e);return a(t),a},e["fantasy-land/of"]=e;var a=!1;return Object.defineProperty(e,"HALT",{get:function(){return a||console.log("HALT is deprecated and has been renamed to SKIP"),a=!0,e.SKIP}}),e}));
//# sourceMappingURL=mithril-stream-standalone.umd.js.map
