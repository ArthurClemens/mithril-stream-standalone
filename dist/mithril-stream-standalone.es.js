function n(n){return r((function(){return n.map((function(n){return n()}))}),n)}function t(n){return"pending"===n._state||"active"===n._state||"changing"===n._state}var e=function(n){var a,u=[],c=[];function i(r){return arguments.length&&r!==e.SKIP&&(n=r,t(i)&&(i._changing(),i._state="active",u.slice().forEach((function(e,r){t(e)&&e(this[r](n))}),c.slice()))),n}function o(){return(a=e()).map((function(n){return!0===n&&(i._parents.forEach((function(n){n._unregisterChild(i)})),i._state="ended",i._parents.length=u.length=c.length=0),n})),a}return i.constructor=e,i._state=arguments.length&&n!==e.SKIP?"active":"pending",i._parents=[],i._changing=function(){t(i)&&(i._state="changing"),u.forEach((function(n){n._changing()}))},i._map=function(t,r){var a=r?e():e(t(n));return a._parents.push(i),u.push(a),c.push(t),a},i.map=function(n){return i._map(n,"active"!==i._state)},i.toJSON=function(){return null!=n&&"function"==typeof n.toJSON?n.toJSON():n},i["fantasy-land/map"]=i.map,i["fantasy-land/ap"]=function(n){return r((function(n,t){return n()(t())}),[n,i])},i._unregisterChild=function(n){var t=u.indexOf(n);-1!==t&&(u.splice(t,1),c.splice(t,1))},Object.defineProperty(i,"end",{get:function(){return a||o()}}),i};function r(n,t){var r=t.every((function(n){if(n.constructor!==e)throw new Error("Ensure that each item passed to stream.combine/stream.merge/lift is a stream.");return"active"===n._state})),a=r?e(n.apply(null,t.concat([t]))):e(),u=[],c=t.map((function(e){return e._map((function(c){return u.push(e),(r||t.every((function(n){return"pending"!==n._state})))&&(r=!0,a(n.apply(null,t.concat([u]))),u=[]),c}),!0)})),i=a.end.map((function(n){!0===n&&(c.forEach((function(n){n.end(!0)})),i.end(!0))}));return a}e.SKIP={},e.lift=function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return n(e).map((function(n){return t.apply(void 0,n)}))},e.scan=function(n,t,r){var a=r.map((function(r){var a=n(t,r);return a!==e.SKIP&&(t=a),a}));return a(t),a},e.merge=n,e.combine=r,e.scanMerge=function(n,t){var e=n.map((function(n){return n[0]})),a=r((function(){var r=arguments[arguments.length-1];return e.forEach((function(e,a){r.indexOf(e)>-1&&(t=n[a][1](t,e()))})),t}),e);return a(t),a},e["fantasy-land/of"]=e;var a=!1;Object.defineProperty(e,"HALT",{get:function(){return a||console.log("HALT is deprecated and has been renamed to SKIP"),a=!0,e.SKIP}});export{e as default};
//# sourceMappingURL=mithril-stream-standalone.es.js.map
